<div class="app-container" [ngClass]="(currentTheme$ | async) + '-theme'">
  <!-- Top Navigation Bar -->
  <p-menubar class="main-menubar">
    <ng-template pTemplate="start">
      <button pButton 
              icon="pi pi-bars" 
              class="p-button-text p-button-rounded sidebar-toggle" 
              (click)="toggleSidebar()"
              aria-label="Toggle Sidebar">
      </button>
      <span class="brand-title">Document Management System</span>
    </ng-template>
    
    <ng-template pTemplate="end">
      <ng-container *ngIf="currentUser$ | async as user; else authButtons">
        <!-- User Section -->
        <div class="user-section">
          <!-- Theme Toggle -->
          <app-theme-toggle></app-theme-toggle>
          
          <!-- User Info -->
          <div class="user-info">
            <span class="username">{{ user.username }}</span>
            <p-avatar 
              [label]="user.username.charAt(0).toUpperCase() || 'U'" 
              shape="circle" 
              size="normal"
              class="user-avatar">
            </p-avatar>
          </div>
          
          <!-- User Menu -->
          <p-menu #userMenu 
                  [popup]="true" 
                  [model]="userMenuItems" 
                  appendTo="body">
          </p-menu>
          <button pButton 
                  icon="pi pi-ellipsis-v" 
                  class="p-button-text p-button-rounded user-menu-btn" 
                  (click)="userMenu.toggle($event)"
                  aria-label="User Menu">
          </button>
        </div>
      </ng-container>
      
      <ng-template #authButtons>
        <div class="auth-section">
          <app-theme-toggle></app-theme-toggle>
          <button pButton 
                  label="Login" 
                  class="p-button-text" 
                  routerLink="/auth/login">
          </button>
          <button pButton 
                  label="Register" 
                  class="p-button-outlined" 
                  routerLink="/auth/register">
          </button>
        </div>
      </ng-template>
    </ng-template>
  </p-menubar>

  <!-- Responsive Sidebar -->
  <p-sidebar [(visible)]="sidebarVisible" 
              position="left" 
              [modal]="false" 
              [showCloseIcon]="true"
              class="main-sidebar">
    <div class="sidebar-content">
      <div class="sidebar-header">
        <h3>Navigation</h3>
      </div>
      
      <div class="sidebar-menu">
        <a class="sidebar-item" 
           routerLink="/dashboard" 
           routerLinkActive="active"
           (click)="sidebarVisible = false">
          <i class="pi pi-home"></i>
          <span>Dashboard</span>
        </a>
        
        <a class="sidebar-item" 
           routerLink="/documents" 
           routerLinkActive="active"
           (click)="sidebarVisible = false">
          <i class="pi pi-folder"></i>
          <span>Documents</span>
        </a>
        
        <a class="sidebar-item" 
           routerLink="/documents/upload" 
           routerLinkActive="active"
           (click)="sidebarVisible = false">
          <i class="pi pi-cloud-upload"></i>
          <span>Upload</span>
        </a>
        
        <a class="sidebar-item" 
           routerLink="/documents/shared" 
           routerLinkActive="active"
           (click)="sidebarVisible = false">
          <i class="pi pi-users"></i>
          <span>Shared with me</span>
        </a>
        
        <a class="sidebar-item" 
           routerLink="/notifications" 
           routerLinkActive="active"
           (click)="sidebarVisible = false">
          <i class="pi pi-bell"></i>
          <span>Notifications</span>
          <p-badge *ngIf="(unreadCount$ | async) || 0 > 0" 
                   [value]="(unreadCount$ | async) || 0" 
                   severity="danger">
          </p-badge>
        </a>
      </div>
    </div>
  </p-sidebar>

  <!-- Main Content Area -->
  <div class="main-content" [class.sidebar-open]="sidebarVisible">
    <div class="container">
      <router-outlet></router-outlet>
    </div>
  </div>
</div> 